<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ö–æ—Ç lov —á–∏—Ç –º—ã—à–µ–π - –≠–ø–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Georgia', serif;
            overflow: hidden;
            cursor: none;
            touch-action: none;
            transition: all 0.5s ease;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            transition: all 1s ease;
            background-size: cover;
            background-position: center;
        }

        /* –õ–æ–∫–∞—Ü–∏–∏ */
        .location-living-room {
            background: linear-gradient(45deg, #8B4513, #A0522D),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23D2B48C"/><rect x="0" y="0" width="20" height="20" fill="%23CD853F"/><rect x="40" y="40" width="20" height="20" fill="%23CD853F"/><rect x="80" y="80" width="20" height="20" fill="%23CD853F"/></svg>');
        }

        .location-kitchen {
            background: linear-gradient(45deg, #F0F8FF, #E6E6FA),
                        repeating-linear-gradient(45deg, #FFF 0px, #FFF 10px, #F5F5F5 10px, #F5F5F5 20px);
        }

        .location-hall {
            background: linear-gradient(45deg, #2F4F4F, #708090),
                        repeating-linear-gradient(0deg, transparent 0px, rgba(255,255,255,0.1) 1px, transparent 2px, transparent 50px);
        }

        .location-bedroom {
            background: linear-gradient(45deg, #FFB6C1, #FFC0CB),
                        radial-gradient(circle at 50% 50%, rgba(255,255,255,0.3) 0%, transparent 70%);
        }

        .location-barn {
            background: linear-gradient(45deg, #8B4513, #A0522D),
                        repeating-linear-gradient(90deg, #654321 0px, #654321 5px, #8B4513 5px, #8B4513 15px);
        }

        .location-farm {
            background: linear-gradient(45deg, #228B22, #32CD32),
                        repeating-linear-gradient(45deg, #228B22 0px, #228B22 20px, #90EE90 20px, #90EE90 40px);
        }

        .location-field {
            background: linear-gradient(45deg, #9ACD32, #ADFF2F),
                        radial-gradient(ellipse at 30% 70%, rgba(255,255,0,0.3) 0%, transparent 50%);
        }

        .location-forest {
            background: linear-gradient(45deg, #006400, #228B22),
                        repeating-radial-gradient(circle at 20% 80%, #654321 0px, #654321 3px, transparent 3px, transparent 20px);
        }

        .ui-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            flex-wrap: wrap;
            gap: 10px;
        }

        .score-panel {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .score, .level, .location-name {
            background: rgba(139, 69, 19, 0.95);
            color: #F5DEB3;
            padding: 8px 15px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #DEB887;
        }

        .game-title {
            color: #F5DEB3;
            font-size: 16px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            text-align: center;
        }

        .achievements {
            position: fixed;
            top: 80px;
            right: 10px;
            max-width: 250px;
            z-index: 1100;
        }

        .achievement {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #8B4513;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            animation: achievementPop 3s ease-out forwards;
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.5);
        }

        .power-ups {
            position: fixed;
            bottom: 10px;
            left: 10px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .power-up {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .power-up.available {
            background: linear-gradient(45deg, #32CD32, #00FF00);
            animation: powerUpPulse 2s ease-in-out infinite;
        }

        .power-up.cooldown {
            background: linear-gradient(45deg, #696969, #A9A9A9);
            opacity: 0.5;
        }

        .cat {
            position: absolute;
            width: 80px;
            height: 90px;
            transition: all 0.15s ease;
            z-index: 100;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4));
            animation: catFloat 2s ease-in-out infinite;
        }

        .cat.dash {
            transition: all 0.1s ease;
            transform: scale(1.2);
        }

        .cat svg {
            width: 100%;
            height: 100%;
        }

        .mouse {
            position: absolute;
            width: 32px;
            height: 32px;
            z-index: 50;
            animation: mouseMove 2.5s linear infinite;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.4));
            cursor: pointer;
        }

        .mouse.red {
            filter: hue-rotate(0deg) saturate(1.5) brightness(1.2) drop-shadow(0 2px 8px rgba(255, 0, 0, 0.6));
            animation: redMouseMove 1.5s ease-in-out infinite;
        }

        .mouse.golden {
            filter: hue-rotate(45deg) saturate(2) brightness(1.5) drop-shadow(0 2px 12px rgba(255, 215, 0, 0.8));
            animation: goldenMouseMove 1s ease-in-out infinite;
        }

        .mouse.silver {
            filter: hue-rotate(180deg) saturate(0.5) brightness(1.8) drop-shadow(0 2px 10px rgba(192, 192, 192, 0.8));
        }

        .mouse.ninja {
            opacity: 0.6;
            animation: ninjaMouseMove 0.8s ease-in-out infinite;
        }

        .cheese {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border-radius: 15px 15px 15px 5px;
            z-index: 45;
            animation: cheeseRotate 2s linear infinite;
            cursor: pointer;
        }

        .cheese::before {
            content: 'üßÄ';
            position: absolute;
            font-size: 20px;
            left: 3px;
            top: 3px;
        }

        .mouse-body {
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at 40% 30%, #E5E5E5, #B8B8B8, #8C8C8C, #696969);
            border-radius: 55% 45% 45% 55%;
            position: relative;
            border: 1px solid #5A5A5A;
        }

        .mouse-ears, .mouse-tail, .mouse-eyes, .mouse-nose, .mouse-whiskers {
            position: absolute;
        }

        .mouse-ears {
            top: -5px;
            left: 7px;
        }

        .mouse-ear {
            width: 10px;
            height: 10px;
            background: radial-gradient(circle at 30% 30%, #E5E5E5, #B8B8B8, #8C8C8C);
            border-radius: 50%;
            position: absolute;
            border: 1px solid #5A5A5A;
        }

        .mouse-ear::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, #FFB6C1, #FF69B4);
            border-radius: 50%;
        }

        .mouse-ear:first-child { left: 0; }
        .mouse-ear:last-child { left: 6px; }

        .mouse-tail {
            width: 2px;
            height: 24px;
            background: linear-gradient(to bottom, #B8B8B8, #8C8C8C, #696969);
            border-radius: 2px;
            right: -1px;
            top: 10px;
            transform-origin: top;
            animation: mouseTailWag 1.8s ease-in-out infinite alternate;
            border: 1px solid #5A5A5A;
        }

        .mouse-eyes {
            top: 7px;
            left: 10px;
            display: flex;
            gap: 3px;
        }

        .mouse-eye {
            width: 3px;
            height: 3px;
            background: radial-gradient(circle, #000, #333);
            border-radius: 50%;
            animation: mouseBlink 3.5s infinite;
        }

        .mouse-nose {
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 2px;
            background: #FF69B4;
            border-radius: 50%;
        }

        .mouse-whiskers {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 26px;
            height: 8px;
        }

        .mouse-whisker {
            position: absolute;
            width: 10px;
            height: 0.5px;
            background: #444;
            border-radius: 1px;
        }

        .mouse-whisker:nth-child(1) { top: 2px; left: 0; transform: rotate(-10deg); }
        .mouse-whisker:nth-child(2) { top: 4px; left: 1px; transform: rotate(-3deg); }
        .mouse-whisker:nth-child(3) { top: 2px; right: 0; transform: rotate(10deg); }
        .mouse-whisker:nth-child(4) { top: 4px; right: 1px; transform: rotate(3deg); }

        .catch-effect {
            position: absolute;
            width: 50px;
            height: 50px;
            border: 3px solid #FFD700;
            border-radius: 50%;
            animation: catchEffect 0.5s ease-out;
            pointer-events: none;
            z-index: 200;
        }

        .catch-effect.special {
            border-color: #FF69B4;
            animation: specialCatchEffect 0.8s ease-out;
        }

        .points-popup {
            position: absolute;
            color: #FFD700;
            font-weight: bold;
            font-size: 18px;
            animation: pointsPopup 1s ease-out forwards;
            pointer-events: none;
            z-index: 201;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .multiplier-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
            animation: multiplierPulse 0.5s ease-out infinite alternate;
            z-index: 300;
        }

        .slow-motion {
            animation-duration: 5s !important;
        }

        .night-mode {
            filter: brightness(0.3) contrast(1.2);
        }

        .night-mode .mouse {
            filter: brightness(2) drop-shadow(0 0 10px #00FF00);
        }

        .avalanche-warning {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 15px;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            z-index: 400;
            animation: warningPulse 1s ease-in-out 3;
        }

        @keyframes catFloat {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-3px) scale(1.02); }
        }

        @keyframes mouseMove {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-2px); }
        }

        @keyframes redMouseMove {
            0% { transform: translateX(0px) translateY(0px) rotate(0deg); }
            25% { transform: translateX(10px) translateY(-5px) rotate(90deg); }
            50% { transform: translateX(0px) translateY(-10px) rotate(180deg); }
            75% { transform: translateX(-10px) translateY(-5px) rotate(270deg); }
            100% { transform: translateX(0px) translateY(0px) rotate(360deg); }
        }

        @keyframes goldenMouseMove {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(180deg); }
        }

        @keyframes ninjaMouseMove {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 0.1; }
        }

        @keyframes cheeseRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes mouseTailWag {
            0% { transform: rotate(-10deg); }
            100% { transform: rotate(10deg); }
        }

        @keyframes mouseBlink {
            0%, 92%, 100% { transform: scaleY(1); }
            96% { transform: scaleY(0.1); }
        }

        @keyframes catchEffect {
            0% { transform: scale(0.5); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        @keyframes specialCatchEffect {
            0% { transform: scale(0.3) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.5) rotate(180deg); opacity: 0.8; }
            100% { transform: scale(3) rotate(360deg); opacity: 0; }
        }

        @keyframes pointsPopup {
            0% { transform: translateY(0px) scale(0.5); opacity: 1; }
            50% { transform: translateY(-20px) scale(1.2); opacity: 1; }
            100% { transform: translateY(-40px) scale(1); opacity: 0; }
        }

        @keyframes achievementPop {
            0% { transform: translateX(300px); opacity: 0; }
            20% { transform: translateX(0px); opacity: 1; }
            80% { transform: translateX(0px); opacity: 1; }
            100% { transform: translateX(300px); opacity: 0; }
        }

        @keyframes powerUpPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px rgba(50, 205, 50, 0.5); }
            50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(50, 205, 50, 0.8); }
        }

        @keyframes multiplierPulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1.1); }
        }

        @keyframes warningPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .score-panel { flex-direction: column; gap: 5px; }
            .score, .level, .location-name { font-size: 12px; padding: 6px 12px; }
            .cat { width: 70px; height: 80px; }
            .power-up { width: 40px; height: 40px; font-size: 16px; }
            .achievement { font-size: 11px; max-width: 200px; }
        }
    </style>
</head>
<body>
    <div class="game-container location-living-room" id="gameContainer">
        <div class="ui-panel">
            <div class="score-panel">
                <div class="score">–û—á–∫–∏: <span id="scoreValue">0</span></div>
                <div class="level">–£—Ä–æ–≤–µ–Ω—å: <span id="levelValue">1</span></div>
                <div class="location-name" id="locationName">–ì–æ—Å—Ç–∏–Ω–∞—è</div>
            </div>
            <div class="game-title">üê± –≠–ø–∏—á–Ω–∞—è –æ—Ö–æ—Ç–∞ –∑–∞ –º—ã—à–∞–º–∏ üê≠</div>
        </div>
        
        <div class="achievements" id="achievements"></div>
        
        <div class="power-ups">
            <div class="power-up cooldown" id="dashPowerUp" title="–ö–æ—à–∞—á–∏–π —Ä—ã–≤–æ–∫">‚ö°</div>
            <div class="power-up cooldown" id="magnetPowerUp" title="–ú–∞–≥–Ω–∏—Ç">üß≤</div>
            <div class="power-up cooldown" id="multiplierPowerUp" title="x2 –û—á–∫–∏">‚ú®</div>
        </div>
        
        <div class="cat" id="cat">
            <svg width="200" height="180" viewBox="0 0 200 180" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="100" cy="165" rx="35" ry="6" fill="rgba(0,0,0,0.1)"/>
                <ellipse cx="100" cy="90" rx="50" ry="45" fill="white" stroke="#DDD" stroke-width="1"/>
                <path d="M65 60 Q70 45 85 50 Q90 55 85 70 Q75 75 65 70 Z" fill="#FF8C42"/>
                <path d="M115 55 Q130 50 135 65 Q140 80 125 85 Q115 80 115 70 Z" fill="#8B4513"/>
                <ellipse cx="110" cy="75" rx="8" ry="6" fill="#FF8C42"/>
                <ellipse cx="70" cy="55" rx="15" ry="25" fill="white" stroke="#DDD" stroke-width="1" transform="rotate(-20 70 55)"/>
                <ellipse cx="130" cy="55" rx="15" ry="25" fill="white" stroke="#DDD" stroke-width="1" transform="rotate(20 130 55)"/>
                <ellipse cx="70" cy="50" rx="12" ry="20" fill="#FF8C42" transform="rotate(-20 70 50)"/>
                <ellipse cx="130" cy="50" rx="12" ry="20" fill="#8B4513" transform="rotate(20 130 50)"/>
                <ellipse cx="70" cy="55" rx="6" ry="12" fill="#FFB3C1" transform="rotate(-20 70 55)"/>
                <ellipse cx="130" cy="55" rx="6" ry="12" fill="#FFB3C1" transform="rotate(20 130 55)"/>
                
                <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–ª–∞–∑–∞ -->
                <g id="catEyes">
                    <path d="M80 85 Q85 90 90 85" fill="none" stroke="#333" stroke-width="3" stroke-linecap="round">
                        <animate attributeName="d" values="M80 85 Q85 90 90 85;M80 87 Q85 88 90 87;M80 85 Q85 90 90 85" dur="4s" repeatCount="indefinite"/>
                    </path>
                    <path d="M110 85 Q115 90 120 85" fill="none" stroke="#333" stroke-width="3" stroke-linecap="round">
                        <animate attributeName="d" values="M110 85 Q115 90 120 85;M110 87 Q115 88 120 87;M110 85 Q115 90 120 85" dur="4s" repeatCount="indefinite"/>
                    </path>
                </g>
                
                <path d="M97 95 L100 100 L103 95 Q100 92 97 95" fill="#FF9999"/>
                <path d="M100 100 Q95 105 88 102" fill="none" stroke="#FF9999" stroke-width="2" stroke-linecap="round"/>
                <path d="M100 100 Q105 105 112 102" fill="none" stroke="#FF9999" stroke-width="2" stroke-linecap="round"/>
                <circle cx="65" cy="100" r="8" fill="#FFB3C1" opacity="0.6"/>
                <circle cx="135" cy="100" r="8" fill="#FFB3C1" opacity="0.6"/>
                <ellipse cx="75" cy="140" rx="12" ry="18" fill="white" stroke="#DDD" stroke-width="1"/>
                <ellipse cx="125" cy="140" rx="12" ry="18" fill="white" stroke="#DDD" stroke-width="1"/>
                <ellipse cx="75" cy="150" rx="8" ry="6" fill="#FFB3C1"/>
                <ellipse cx="125" cy="150" rx="8" ry="6" fill="#FFB3C1"/>
                <circle cx="70" cy="148" r="2.5" fill="#FFB3C1"/>
                <circle cx="75" cy="145" r="2" fill="#FFB3C1"/>
                <circle cx="80" cy="148" r="2.5" fill="#FFB3C1"/>
                <circle cx="120" cy="148" r="2.5" fill="#FFB3C1"/>
                <circle cx="125" cy="145" r="2" fill="#FFB3C1"/>
                <circle cx="130" cy="148" r="2.5" fill="#FFB3C1"/>
                <ellipse cx="90" cy="88" rx="3" ry="2" fill="#8B4513"/>
                <line x1="60" y1="95" x2="45" y2="90" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="60" y1="100" x2="45" y2="100" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="60" y1="105" x2="45" y2="110" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="140" y1="95" x2="155" y2="90" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="140" y1="100" x2="155" y2="100" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="140" y1="105" x2="155" y2="110" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const gameContainer = document.getElementById('gameContainer');
        const cat = document.getElementById('cat');
        const scoreElement = document.getElementById('scoreValue');
        const levelElement = document.getElementById('levelValue');
        const locationElement = document.getElementById('locationName');
        const achievementsContainer = document.getElementById('achievements');
        
        let gameState = {
            score: 0,
            level: 1,
            miceCount: 0,
            catPosition: { x: window.innerWidth / 2, y: window.innerHeight / 2 },
            mice: [],
            cheeses: [],
            isMoving: false,
            spawnSpeed: 3000,
            mouseLifetime: 10000,
            currentLocation: 0,
            powerUps: {
                dash: { available: false, cooldown: 5000 },
                magnet: { available: false, cooldown: 8000 },
                multiplier: { available: false, cooldown: 12000, active: false, duration: 10000 }
            },
            effects: {
                slowMotion: false,
                nightMode: false
            },
            achievements: new Set(),
            playTime: 0,
            lastRedMouse: 0,
            redMouseStreak: 0
        };

        const locations = [
            { name: '–ì–æ—Å—Ç–∏–Ω–∞—è', className: 'location-living-room' },
            { name: '–ö—É—Ö–Ω—è', className: 'location-kitchen' },
            { name: '–ó–∞–ª', className: 'location-hall' },
            { name: '–°–ø–∞–ª—å–Ω—è', className: 'location-bedroom' },
            { name: '–°–∞—Ä–∞–π', className: 'location-barn' },
            { name: '–§–µ—Ä–º–∞', className: 'location-farm' },
            { name: '–ü–æ–ª–µ', className: 'location-field' },
            { name: '–õ–µ—Å', className: 'location-forest' }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateCatPosition();
        updateUI();
        startGameTimer();
        initPowerUps();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å–∞–Ω–∏–π –∏ –¥–≤–∏–∂–µ–Ω–∏—è
        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches ? e.touches[0] : e;
            const rect = gameContainer.getBoundingClientRect();
            
            const targetX = touch.clientX - rect.left - 40;
            const targetY = touch.clientY - rect.top - 45;
            
            gameState.catPosition.x = Math.max(0, Math.min(window.innerWidth - 80, targetX));
            gameState.catPosition.y = Math.max(0, Math.min(window.innerHeight - 90, targetY));
            
            updateCatPosition();
        }

        // –°–æ–±—ã—Ç–∏—è
        gameContainer.addEventListener('touchstart', handleTouch, { passive: false });
        gameContainer.addEventListener('touchmove', handleTouch, { passive: false });
        gameContainer.addEventListener('mousedown', (e) => {
            gameState.isMoving = true;
            handleTouch(e);
        });
        gameContainer.addEventListener('mousemove', (e) => {
            if (gameState.isMoving) handleTouch(e);
        });
        gameContainer.addEventListener('mouseup', () => {
            gameState.isMoving = false;
        });

        // –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –¥–ª—è —Ä—ã–≤–∫–∞
        let lastClickTime = 0;
        gameContainer.addEventListener('click', (e) => {
            const currentTime = Date.now();
            if (currentTime - lastClickTime < 300 && gameState.powerUps.dash.available) {
                activateDash();
            }
            lastClickTime = currentTime;
        });

        function updateCatPosition() {
            cat.style.left = gameState.catPosition.x + 'px';
            cat.style.top = gameState.catPosition.y + 'px';
        }

        function updateUI() {
            scoreElement.textContent = gameState.score;
            levelElement.textContent = gameState.level;
            locationElement.textContent = locations[gameState.currentLocation].name;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –º—ã—à–µ–π
        function createMouse(type = 'normal') {
            const mouse = document.createElement('div');
            mouse.className = `mouse ${type}`;
            
            const margin = 50;
            let x = Math.random() * (window.innerWidth - 32 - margin * 2) + margin;
            let y = Math.random() * (window.innerHeight - 32 - margin * 2) + margin;
            
            mouse.style.left = x + 'px';
            mouse.style.top = y + 'px';
            
            mouse.innerHTML = `
                <div class="mouse-body">
                    <div class="mouse-ears">
                        <div class="mouse-ear"></div>
                        <div class="mouse-ear"></div>
                    </div>
                    <div class="mouse-eyes">
                        <div class="mouse-eye"></div>
                        <div class="mouse-eye"></div>
                    </div>
                    <div class="mouse-nose"></div>
                    <div class="mouse-whiskers">
                        <div class="mouse-whisker"></div>
                        <div class="mouse-whisker"></div>
                        <div class="mouse-whisker"></div>
                        <div class="mouse-whisker"></div>
                    </div>
                    <div class="mouse-tail"></div>
                </div>
            `;
            
            const mouseData = {
                element: mouse,
                x: x,
                y: y,
                type: type,
                direction: Math.random() * 360,
                speed: type === 'red' ? 2 : 1
            };
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –∫—Ä–∞—Å–Ω—ã—Ö –º—ã—à–µ–π
            if (type === 'red') {
                moveRedMouse(mouseData);
            }
            
            gameContainer.appendChild(mouse);
            gameState.mice.push(mouseData);

            // –£–¥–∞–ª–µ–Ω–∏–µ –º—ã—à–∏ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
            const lifetime = type === 'golden' ? 5000 : gameState.mouseLifetime;
            setTimeout(() => {
                if (gameContainer.contains(mouse)) {
                    gameContainer.removeChild(mouse);
                    gameState.mice = gameState.mice.filter(m => m.element !== mouse);
                }
            }, lifetime);
            
            return mouseData;
        }

        function moveRedMouse(mouseData) {
            setInterval(() => {
                if (!gameContainer.contains(mouseData.element)) return;
                
                mouseData.direction += (Math.random() - 0.5) * 30;
                const radians = mouseData.direction * Math.PI / 180;
                
                mouseData.x += Math.cos(radians) * mouseData.speed;
                mouseData.y += Math.sin(radians) * mouseData.speed;
                
                // –û—Ç—Å–∫–æ–∫ –æ—Ç –≥—Ä–∞–Ω–∏—Ü
                if (mouseData.x <= 0 || mouseData.x >= window.innerWidth - 32) {
                    mouseData.direction = 180 - mouseData.direction;
                    mouseData.x = Math.max(0, Math.min(window.innerWidth - 32, mouseData.x));
                }
                if (mouseData.y <= 0 || mouseData.y >= window.innerHeight - 32) {
                    mouseData.direction = -mouseData.direction;
                    mouseData.y = Math.max(0, Math.min(window.innerHeight - 32, mouseData.y));
                }
                
                mouseData.element.style.left = mouseData.x + 'px';
                mouseData.element.style.top = mouseData.y + 'px';
            }, 50);
        }

        function createCheese() {
            const cheese = document.createElement('div');
            cheese.className = 'cheese';
            
            const margin = 50;
            const x = Math.random() * (window.innerWidth - 30 - margin * 2) + margin;
            const y = Math.random() * (window.innerHeight - 30 - margin * 2) + margin;
            
            cheese.style.left = x + 'px';
            cheese.style.top = y + 'px';
            cheese.onclick = () => collectCheese(cheese);
            
            gameContainer.appendChild(cheese);
            gameState.cheeses.push(cheese);
            
            setTimeout(() => {
                if (gameContainer.contains(cheese)) {
                    gameContainer.removeChild(cheese);
                    gameState.cheeses = gameState.cheeses.filter(c => c !== cheese);
                }
            }, 8000);
        }

        function collectCheese(cheese) {
            if (!gameContainer.contains(cheese)) return;
            
            createPointsPopup(cheese.offsetLeft, cheese.offsetTop, '+3');
            addScore(3);
            gameContainer.removeChild(cheese);
            gameState.cheeses = gameState.cheeses.filter(c => c !== cheese);
        }

        // –°–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤ –∏ –ø–æ–∏–º–∫–∏
        function addScore(points) {
            const multiplier = gameState.powerUps.multiplier.active ? 2 : 1;
            gameState.score += points * multiplier;
            updateUI();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω—è
            const newLevel = Math.floor(gameState.score / 50) + 1;
            if (newLevel > gameState.level) {
                gameState.level = newLevel;
                levelUp();
            }
            
            // –°–º–µ–Ω–∞ –ª–æ–∫–∞—Ü–∏–∏ –∫–∞–∂–¥—ã–µ 100 –æ—á–∫–æ–≤
            const newLocation = Math.floor(gameState.score / 100) % locations.length;
            if (newLocation !== gameState.currentLocation) {
                changeLocation(newLocation);
            }
        }

        function catchMouse(mouse, index) {
            createCatchEffect(mouse.x + 16, mouse.y + 16, mouse.type !== 'normal');
            
            let points = 1;
            if (mouse.type === 'red') {
                points = 2;
                gameState.redMouseStreak++;
                if (gameState.redMouseStreak >= 5) {
                    showAchievement('–ö–æ—à–∞—á–∏–π —Å–Ω–∞–π–ø–µ—Ä', '5 –∫—Ä–∞—Å–Ω—ã—Ö –º—ã—à–µ–π –ø–æ–¥—Ä—è–¥!');
                    gameState.achievements.add('sniper');
                }
            } else if (mouse.type === 'golden') {
                points = 5;
            } else {
                gameState.redMouseStreak = 0;
            }
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            if (mouse.type === 'silver') {
                activateSlowMotion();
            }
            
            createPointsPopup(mouse.x, mouse.y, `+${points}`);
            addScore(points);
            
            gameContainer.removeChild(mouse.element);
            gameState.mice.splice(index, 1);
            gameState.miceCount++;
            
            // –í–∏–±—Ä–∞—Ü–∏—è
            if (navigator.vibrate) {
                navigator.vibrate(mouse.type === 'normal' ? 50 : 100);
            }
            
            checkAchievements();
        }

        function levelUp() {
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è –º—ã—à–µ–π –Ω–∞ 10%
            gameState.spawnSpeed = Math.max(800, gameState.spawnSpeed * 0.9);
            gameState.mouseLifetime = Math.max(3000, gameState.mouseLifetime * 0.95);
            
            showAchievement('–ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è!', `–£—Ä–æ–≤–µ–Ω—å ${gameState.level}`);
            
            // –ú–µ–Ω—è–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ç–∞
            updateCatExpression();
        }

        function changeLocation(newLocationIndex) {
            gameState.currentLocation = newLocationIndex;
            const location = locations[newLocationIndex];
            
            gameContainer.className = `game-container ${location.className}`;
            showAchievement('–ù–æ–≤–∞—è –ª–æ–∫–∞—Ü–∏—è!', location.name);
            updateUI();
        }

        function updateCatExpression() {
            const catEyes = document.getElementById('catEyes');
            if (gameState.level <= 2) {
                // –°–æ–Ω–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
            } else if (gameState.level <= 5) {
                // –ó–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ–µ
                catEyes.innerHTML = `
                    <circle cx="85" cy="87" r="4" fill="#333"/>
                    <circle cx="115" cy="87" r="4" fill="#333"/>
                    <circle cx="87" cy="85" r="1" fill="white"/>
                    <circle cx="117" cy="85" r="1" fill="white"/>
                `;
            } else {
                // –ê–∑–∞—Ä—Ç–Ω–æ–µ
                catEyes.innerHTML = `
                    <ellipse cx="85" cy="87" rx="5" ry="3" fill="#FF4500"/>
                    <ellipse cx="115" cy="87" rx="5" ry="3" fill="#FF4500"/>
                    <circle cx="87" cy="85" r="1" fill="white"/>
                    <circle cx="117" cy="85" r="1" fill="white"/>
                `;
            }
        }

        // –°–∏—Å—Ç–µ–º–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
        function initPowerUps() {
            document.getElementById('dashPowerUp').onclick = () => {
                if (gameState.powerUps.dash.available) activateDash();
            };
            
            document.getElementById('magnetPowerUp').onclick = () => {
                if (gameState.powerUps.magnet.available) activateMagnet();
            };
            
            document.getElementById('multiplierPowerUp').onclick = () => {
                if (gameState.powerUps.multiplier.available) activateMultiplier();
            };
            
            // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏
            setInterval(() => {
                if (!gameState.powerUps.dash.available) {
                    gameState.powerUps.dash.available = true;
                    updatePowerUpUI('dashPowerUp', true);
                }
            }, gameState.powerUps.dash.cooldown);
            
            setInterval(() => {
                if (!gameState.powerUps.magnet.available) {
                    gameState.powerUps.magnet.available = true;
                    updatePowerUpUI('magnetPowerUp', true);
                }
            }, gameState.powerUps.magnet.cooldown);
            
            setInterval(() => {
                if (!gameState.powerUps.multiplier.available) {
                    gameState.powerUps.multiplier.available = true;
                    updatePowerUpUI('multiplierPowerUp', true);
                }
            }, gameState.powerUps.multiplier.cooldown);
        }

        function activateDash() {
            gameState.powerUps.dash.available = false;
            updatePowerUpUI('dashPowerUp', false);
            
            cat.classList.add('dash');
            setTimeout(() => cat.classList.remove('dash'), 200);
            
            showAchievement('–ö–æ—à–∞—á–∏–π —Ä—ã–≤–æ–∫!', '–ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å!');
        }

        function activateMagnet() {
            gameState.powerUps.magnet.available = false;
            updatePowerUpUI('magnetPowerUp', false);
            
            gameState.mice.forEach(mouse => {
                const dx = gameState.catPosition.x - mouse.x;
                const dy = gameState.catPosition.y - mouse.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 150) {
                    const moveX = dx * 0.1;
                    const moveY = dy * 0.1;
                    
                    mouse.x += moveX;
                    mouse.y += moveY;
                    mouse.element.style.left = mouse.x + 'px';
                    mouse.element.style.top = mouse.y + 'px';
                }
            });
            
            showAchievement('–ú–∞–≥–Ω–∏—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!', '–ú—ã—à–∏ –ø—Ä–∏—Ç—è–≥–∏–≤–∞—é—Ç—Å—è!');
        }

        function activateMultiplier() {
            gameState.powerUps.multiplier.available = false;
            gameState.powerUps.multiplier.active = true;
            updatePowerUpUI('multiplierPowerUp', false);
            
            const indicator = document.createElement('div');
            indicator.className = 'multiplier-indicator';
            indicator.textContent = 'X2 –û–ß–ö–ò!';
            gameContainer.appendChild(indicator);
            
            setTimeout(() => {
                gameState.powerUps.multiplier.active = false;
                if (gameContainer.contains(indicator)) {
                    gameContainer.removeChild(indicator);
                }
            }, gameState.powerUps.multiplier.duration);
            
            showAchievement('–ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä!', '–î–≤–æ–π–Ω—ã–µ –æ—á–∫–∏ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥!');
        }

        function activateSlowMotion() {
            gameState.effects.slowMotion = true;
            gameContainer.classList.add('slow-motion');
            
            setTimeout(() => {
                gameState.effects.slowMotion = false;
                gameContainer.classList.remove('slow-motion');
            }, 3000);
            
            showAchievement('–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏!', '–í—Å—ë –∑–∞–º–µ–¥–ª–∏–ª–æ—Å—å!');
        }

        function updatePowerUpUI(powerUpId, available) {
            const element = document.getElementById(powerUpId);
            element.className = available ? 'power-up available' : 'power-up cooldown';
        }

        // –°–æ–±—ã—Ç–∏—è –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã
        function triggerMouseAvalanche() {
            const warning = document.createElement('div');
            warning.className = 'avalanche-warning';
            warning.textContent = 'üê≠ –ú–´–®–ò–ù–ê–Ø –õ–ê–í–ò–ù–ê! üê≠';
            gameContainer.appendChild(warning);
            
            setTimeout(() => {
                gameContainer.removeChild(warning);
                
                // –°–æ–∑–¥–∞–µ–º 10 –º—ã—à–µ–π
                for (let i = 0; i < 10; i++) {
                    setTimeout(() => createMouse('normal'), i * 100);
                }
            }, 3000);
        }

        function triggerCheeseRain() {
            showAchievement('–î–æ–∂–¥—å —Å—ã—Ä–∞!', '–°–æ–±–∏—Ä–∞–π—Ç–µ —Å—ã—Ä –¥–ª—è –±–æ–Ω—É—Å–æ–≤!');
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => createCheese(), i * 200);
            }
        }

        function triggerNightMode() {
            gameState.effects.nightMode = true;
            gameContainer.classList.add('night-mode');
            
            showAchievement('–ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º!', '–ú—ã—à–∏ —Å–≤–µ—Ç—è—Ç—Å—è –≤ —Ç–µ–º–Ω–æ—Ç–µ!');
            
            setTimeout(() => {
                gameState.effects.nightMode = false;
                gameContainer.classList.remove('night-mode');
            }, 15000);
        }

        // –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function checkAchievements() {
            if (gameState.miceCount >= 50 && !gameState.achievements.has('novice')) {
                showAchievement('–ú—ã—à–µ–ª–æ–≤-–Ω–æ–≤–∏—á–æ–∫', '50 –ø–æ–π–º–∞–Ω–Ω—ã—Ö –º—ã—à–µ–π!');
                gameState.achievements.add('novice');
            }
            
            if (gameState.miceCount >= 100 && !gameState.achievements.has('expert')) {
                showAchievement('–≠–∫—Å–ø–µ—Ä—Ç-–º—ã—à–µ–ª–æ–≤', '100 –ø–æ–π–º–∞–Ω–Ω—ã—Ö –º—ã—à–µ–π!');
                gameState.achievements.add('expert');
            }
            
            if (gameState.playTime >= 300000 && !gameState.achievements.has('marathon')) {
                showAchievement('–ú–∞—Ä–∞—Ñ–æ–Ω–µ—Ü', '5 –º–∏–Ω—É—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –∏–≥—Ä—ã!');
                gameState.achievements.add('marathon');
            }
        }

        function showAchievement(title, description) {
            const achievement = document.createElement('div');
            achievement.className = 'achievement';
            achievement.innerHTML = `<strong>${title}</strong><br>${description}`;
            
            achievementsContainer.appendChild(achievement);
            
            setTimeout(() => {
                if (achievementsContainer.contains(achievement)) {
                    achievementsContainer.removeChild(achievement);
                }
            }, 3000);
        }

        // –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
        function createCatchEffect(x, y, special = false) {
            const effect = document.createElement('div');
            effect.className = special ? 'catch-effect special' : 'catch-effect';
            effect.style.left = (x - 25) + 'px';
            effect.style.top = (y - 25) + 'px';
            gameContainer.appendChild(effect);
            
            setTimeout(() => {
                if (gameContainer.contains(effect)) {
                    gameContainer.removeChild(effect);
                }
            }, special ? 800 : 500);
        }

        function createPointsPopup(x, y, text) {
            const popup = document.createElement('div');
            popup.className = 'points-popup';
            popup.textContent = text;
            popup.style.left = x + 'px';
            popup.style.top = y + 'px';
            gameContainer.appendChild(popup);
            
            setTimeout(() => {
                if (gameContainer.contains(popup)) {
                    gameContainer.removeChild(popup);
                }
            }, 1000);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π
        function checkCollisions() {
            gameState.mice.forEach((mouse, index) => {
                const mouseRect = mouse.element.getBoundingClientRect();
                const catRect = cat.getBoundingClientRect();
                
                const tolerance = 15;
                
                if (catRect.left < mouseRect.right + tolerance &&
                    catRect.right > mouseRect.left - tolerance &&
                    catRect.top < mouseRect.bottom + tolerance &&
                    catRect.bottom > mouseRect.top - tolerance) {
                    
                    catchMouse(mouse, index);
                }
            });
        }

        // –°–∏—Å—Ç–µ–º–∞ —Å–ø–∞–≤–Ω–∞
        function spawnMice() {
            const maxMice = window.innerWidth < 768 ? 4 : 6;
            
            if (gameState.mice.length < maxMice) {
                const spawnCount = Math.min(3, maxMice - gameState.mice.length);
                
                for (let i = 0; i < spawnCount; i++) {
                    let mouseType = 'normal';
                    
                    // –ö–∞–∂–¥–∞—è 10-—è –º—ã—à—å –∫—Ä–∞—Å–Ω–∞—è
                    if ((gameState.miceCount + i + 1) % 10 === 0) {
                        mouseType = 'red';
                    }
                    // –ö–∞–∂–¥–∞—è 25-—è –º—ã—à—å –∑–æ–ª–æ—Ç–∞—è
                    else if ((gameState.miceCount + i + 1) % 25 === 0) {
                        mouseType = 'golden';
                    }
                    // –ö–∞–∂–¥–∞—è 15-—è –º—ã—à—å —Å–µ—Ä–µ–±—Ä—è–Ω–∞—è
                    else if ((gameState.miceCount + i + 1) % 15 === 0) {
                        mouseType = 'silver';
                    }
                    // –ö–∞–∂–¥–∞—è 20-—è –º—ã—à—å –Ω–∏–Ω–¥–∑—è
                    else if ((gameState.miceCount + i + 1) % 20 === 0) {
                        mouseType = 'ninja';
                    }
                    
                    setTimeout(() => createMouse(mouseType), i * 200);
                }
            }
            
            setTimeout(spawnMice, gameState.spawnSpeed);
        }

        // –°–æ–±—ã—Ç–∏—è
        function triggerRandomEvent() {
            const events = ['avalanche', 'cheese', 'night'];
            const event = events[Math.floor(Math.random() * events.length)];
            
            switch (event) {
                case 'avalanche':
                    if (Math.random() < 0.3) triggerMouseAvalanche();
                    break;
                case 'cheese':
                    if (Math.random() < 0.4) triggerCheeseRain();
                    break;
                case 'night':
                    if (Math.random() < 0.2) triggerNightMode();
                    break;
            }
        }

        // –¢–∞–π–º–µ—Ä—ã
        function startGameTimer() {
            setInterval(() => {
                gameState.playTime += 1000;
                checkAchievements();
            }, 1000);
            
            setInterval(triggerRandomEvent, 30000); // –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        }

        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            checkCollisions();
            requestAnimationFrame(gameLoop);
        }

        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                gameState.catPosition.x = Math.min(gameState.catPosition.x, window.innerWidth - 80);
                gameState.catPosition.y = Math.min(gameState.catPosition.y, window.innerHeight - 90);
                updateCatPosition();
            }, 100);
        });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        document.addEventListener('touchmove', (e) => {
            e.preventDefault();
        }, { passive: false });

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        setTimeout(spawnMice, 1000);
        gameLoop();
        createMouse('normal');
    </script>
</body>
</html>